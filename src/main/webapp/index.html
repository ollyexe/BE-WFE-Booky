<!DOCTYPE html>
<html lang="en" >
<head>

    <title>Login</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>
    <link href="css.css" rel="stylesheet" />
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0" >

</head>
<body>


    <div id="app" >

        <div v-if="role>-1">
            <div v-if="role>-1" id="nav_Bar"><nav class="navbar navbar-expand-lg navbar-light bg-navBar">
                <a class="navbar-brand" href="#"></a>
                <button class="navbar-toggler float-right collapsed" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon "></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item active">
                            <a @click="home_transition" class="nav-link" href="#">Home </a>
                        </li>
                        <li  class="nav-item">
                            <a v-if="role===1" @click="profile_transition" class="nav-link" href="#" >Profilo</a>
                        </li>
                        <li  class="nav-item">
                            <a v-if="role===0" @click="go_to_loginpage" class="nav-link" href="#">Login</a>
                        </li>
                        <li class="nav-item">
                            <a v-if="role===1" class="nav-link " href="#" >Ordini passati</a>
                        </li>
                        <li class="nav-item">
                            <a v-if="role===2" class="nav-link " href="#" >Visualizza Storici</a>
                        </li>
                        <li class="nav-item">
                            <a v-if="role===2" class="nav-link " href="#" >Inserisci Docenti</a>
                        </li>
                        <li class="nav-item">
                            <a v-if="role===0||role===1" class="nav-link " href="#" >Assistenza</a>
                        </li>
                    </ul>
                </div>
            </nav></div>


            <div v-if="home" id="home_page" >
                <section id="cover" >
                    <div class="p-3 mb-2 bg-filter__p"></div>
                    <div class="cover__caption justify-content-center">
                        <div class="cover__caption__copy">
                            <h1>PRENOTAZIONE LEZIONI</h1>
                            <h2>lezioni disponibili</h2>
                            <br>
                            <a v-if="role===0" @click="go_to_loginpage" class=" btn button__p">Acquista lezioni</a>
                            <a v-if="role===1" @click="selector_transition" class=" btn button__p">Acquista lezioni</a>
                        </div>
                    </div>
                </section>
            </div>

            <div v-if="selector" id="selector" >
                <div class="row g-0">
                    <div class="col-md-6 g-0">
                        <div class="left-side__b"></div> <!--g-o = no-gutters in bootsrap4-->
                        <div class="left-side d-flex justify-content-center align-items-center left-side_bg_img" >
                            <div class=" justify-content-center" style="z-index: 1">
                                <div class="cover__caption__copy" style="z-index: 1">
                                    <h1>PRENOTAZIONE LEZIONI</h1>
                                    <br>
                                    <h2>in base alla materia</h2>
                                    <br>
                                    <a v-if="role===1" @click="subject_page_transition" class=" btn button__p">Acquista lezioni</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 g-0">
                        <div class="right-side__b"></div>
                        <div class="right-side d-flex justify-content-center align-items-center right-side_bg_img">
                            <div class=" justify-content-center" style="z-index: 1">
                                <div class="cover__caption__copy" style="z-index: 1">
                                    <h1>PRENOTAZIONE LEZIONI</h1>
                                    <br>
                                    <h2>in base al professore</h2>
                                    <br>
                                    <a v-if="role===1" @click="professors_page_transition" class=" btn button__p">Acquista lezioni</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="professors_page" id="prof_page">
                <section class="flex-grow justify-content-lg-between justify-content-lg-evenly flex-wrap" style="display: list-item !important;">
                   <div v-for="docente in docenti"> <div class="card-prof" style="float: left">
                        <div class="image-content-prof">
                            <span class="overlay-prof"></span>
                            <div class="card-image-prof">
                                <img :src="docente['pf']" alt="" class="card-img-prof">
                            </div>
                        </div>
                        <div class="card-content-prof">
                            <p class="name" style="font-size: 20px">Prof. {{ docente['nome'] }} {{ docente['cognome'] }}</p>
                            <p class="description">15:00/19:00</p>
                            <div class="list-inline-item">
                                <a class="description" style="text-decoration: none" v-for="materia in docente['corsi']">{{materia}} </a>
                            </div>
                            <br>
                            <h2 align="center"><button class="button2">ACQUISTA</button></h2>
                        </div>
                    </div>
                   </div>
                </section>
            </div>
            <div v-if="subjects_page" id="subj_page">
                <section class="flex-grow justify-content-lg-between justify-content-lg-evenly flex-wrap" style="display: list-item !important;">
                    <div v-for="materia in materie['corsi']"> <div class="card-prof" style="float: left">
                        <div class="image-content-prof">
                            <span class="overlay-prof"></span>
                            <div class="card-image-prof">
                                <img src="assets/subj_logo.jpg" alt="" class="card-img-prof">
                            </div>
                        </div>
                        <div class="card-content-prof">
                            <p class="name" style="font-size: 20px"> {{ materia }} </p>
                            <p class="description">15:00/19:00</p>
<!--                            <div class="list-inline-item">-->
<!--                                <a class="description" style="text-decoration: none" v-for="materia in docente['corsi']">{{materia}} </a>-->
<!--                            </div>-->
                            <br>
                            <h2 align="center"><button class="button2">ACQUISTA</button></h2>
                        </div>
                    </div>
                    </div>
                </section>
            </div>

            <div v-if="profile" id="profile_page">
                <section class="vh-100" style=" background-image: linear-gradient(120deg,#3498db,#8e44ad);">
                    <div class="container py-5 h-100">
                        <div class="row d-flex justify-content-center align-items-center h-100">
                            <div class="col col-lg-6 mb-4 mb-lg-0">
                                <div class="card mb-3" style="border-radius: .5rem;">
                                    <div class="row g-0">
                                        <div class="col-md-4 gradient-custom text-center text-white"
                                             style="border-top-left-radius: .5rem; border-bottom-left-radius: .5rem;">
                                            <img class="rounded-circle img-fluid my-5" alt="avatar1" :src="utente['pf']" style="width: 80px;" />
                                            <h5>{{utente['nome']}} {{utente['cognome']}}</h5>
                                            <p>{{utente['ruolo']}}</p>
                                            <i class="far fa-edit mb-5"></i>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="card-body p-4">
                                                <h6>Dati</h6>
                                                <hr class="mt-0 mb-4">
                                                <div class="row pt-1">
                                                    <div class="col-6 mb-3">
                                                        <h6>Email</h6>
                                                        <p class="text-muted">{{ email }}</p>
                                                    </div>
                                                    <div class="col-6 mb-3">
                                                        <h6>Phone</h6>
                                                        <p class="text-muted">123 456 789</p>
                                                    </div>
                                                </div>

                                                <hr class="mt-0 mb-4">
                                                <div class="row pt-1">
                                                    <div class="col-6 mb-3">
                                                        <h6>Recent</h6>
                                                        <p class="text-muted">Lorem ipsum</p>
                                                    </div>
                                                    <div class="col-6 mb-3">
                                                        <h6>Most Viewed</h6>
                                                        <p class="text-muted">Dolor sit amet</p>
                                                    </div>
                                                </div>

                                                <div class="btn-group-lg">
                                                    <button @click="reloadPage" class="btn btn-danger text-white"  >Logout</button>
                                                    <button  class="btn bg-navBar text-white " style="float: right"  >Modifica Dati</button>
                                                </div>



                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <a href="#" id="float_img" class="float" style="z-index: 1000">
                <i class="fa fa-plus my-float"></i>
            </a>
        </div>

        <div v-if="role===-1" id="login_page" class="box__p">
            <div class="container__p">
                <form action="signup/signUp.html">
                    <!-- Email input -->
                    <div class="form-outline mb-4">
                        <input v-model="email"  type="email" placeholder="Email"  autocomplete="on" class="form-control" />
                    </div>

                    <!-- Password input -->
                    <div class="form-outline mb-4">
                        <input id="password_input" v-model="pass"   placeholder="Password" type="password" autocomplete="on" class="form-control" />
                    </div>




                    <div>

                        <button @click="login" class="login_button"  value="Login" type="button">Accedi</button>
                        <button  @click="guest_login" class="guest_button text-black"  value="Guest" type="button">Ospite</button>
                        <button class="login_button" style="background: linear-gradient(120deg,#8e44ad,#3498db);" type="submit">Registrazione</button>

                    </div>
                    <div >
                        <a  class="text-danger"  style="text-align: center;text-decoration: none" >{{login_label}}</a>
                    </div>


                </form>
            </div>
        </div>

    </div>



<script>


    var app = new Vue({
        el: '#app',
        data() {
           return {
               email: null,
               pass: '',
               pf: 'https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885__480.jpg',
               home: true,
               profile:false,
               selector:false,
               professors_page:false,
               subjects_page:false,
               role : -1,//-1= none 0 = guest 1 = user 2 = admin
               login_model: '',
               utente:'',
               login_label:'  ',
               docenti:'',
               materie: '',
               selected_materia:'',
               selected_teacher:'',

           }


        },
        mounted(){
            this.get_all_professori()
            this.get_all_materie()
        },

        methods: {
            reloadPage: function() {
                window.location.reload();
            },

            home_transition: function () {
                this.home = true;
                this.profile = false;
                this.selector = false;
                this.professors_page = false;
                this.subjects_page=false

                document.title='Home'


            },
            profile_transition: function () {
                this.home = false;
                this.profile = true;
                this.selector = false;
                this.professors_page = false;
                this.subjects_page=false

                document.title='Profile'
            },
            selector_transition: function () {
                this.home = false;
                this.profile = false;
                this.selector = true;
                this.professors_page = false;
                this.subjects_page=false

                document.title='Selettore'
            },
            professors_page_transition: function () {
                this.home = false;
                this.profile = false;
                this.selector = false;
                this.professors_page = true;
                this.subjects_page=false
                document.title='Professori'
            },
            subject_page_transition: function () {
                this.home = false;
                this.profile = false;
                this.selector = false;
                this.professors_page = false;
                this.subjects_page=true
                document.title='Materie'
            },


            guest_login : function () {
                this.role=0
            },
            login : async function () {

                var self=this

                $.get("apiUtente",{path: "login", mail: this.email, pass: this.pass},
                    function (data) {
                        self.login_model=data
                        if(self.login_model['login_state']==='true'){
                            $.get("apiUtente",{path: "getMiniUser", mail: self.email},
                                function (data){
                                    self.utente=data
                                    if (self.utente['ruolo']==='admin'){
                                        self.role=2
                                    }
                                    else if (self.utente['ruolo']==='utente'){
                                        self.role=1
                                    }

                                }
                            )
                        }
                        else {
                            self.login_label="Controllare I dati"
                        }
                    }
                )
                document.title='Home'
            },
            get_all_professori: async function () {

                var self=this

                await $.get("apiUtente",{path: "getAllDocenti"},
                    function (data) {
                        self.docenti=data
                    }
                )
                console.log(self.docenti)
            },
            get_all_materie: async function () {

                var self=this

                await $.get("apiCorso",{path: "getAllCorsi"},
                    function (data) {
                        self.materie=data
                    }
                )
            },

        },
        watch:{
            pass : function (){
               this.login_label=''
            },
            email : function (){
                this.login_label=''
            }

        }
    });

</script>


</body>
</html>
