<!DOCTYPE html>
<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <!--VueJs-->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!--Css-->
    <link rel="stylesheet" href="singlePagestyle.css">

    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0" >

    <title>Registrazione</title>
</head>
<body>

<!-- App vue -->
<div id="app">
    <!-- Sezione Login -->
    <div  class="box"><!--ruolo <0 perchè succesivamente stabilisce se è ruolo 0 1 o 2-->
        <div class="container">
            <div class="top-header">
                <header>Register</header>
            </div>

            <div class="input-field">
                <input type="text" class="input" v-model="email" id="username_utente" name="username_utente"
                       placeholder="Username" required autofocus>
            </div>

            <div class="input-field">
                <input type="text" class="input" v-model="nome" id="nome" name="nome"
                       placeholder="Nome" required autofocus>
            </div>

            <div class="input-field">
                <input type="text" class="input" v-model="cognome" id="cognome" name="cognome"
                       placeholder="Cognome" required autofocus>
            </div>

            <div class="input-field">
                <input  class="input" v-model="pass" id="password_utente" name="password-utente"
                       placeholder="Password" required autofocus>
            </div>


            <div>
                <button v-on:click="reg" class="signUp_button2" name="signUp_button" value="SignUp">Registrati</button>
            </div>
            <div >
                <a  class="text-danger"  style="text-align: center;text-decoration: none" >{{reg_labl}}</a>
            </div>


            <div>
                <a class="signUp_text" role="article">Sei gia un nostro utente?</a>
                <a href="../index.html" class="login_guest">Accedi</a>
            </div>

        </div>
    </div>
    <!-- Fine Sezione Login -->
</div>
<script>



    var app = new Vue({
        el: '#app',
        data() {
            return {
                email: '',
                pass: '',
                nome:'',
                cognome:'',
                reg_labl:''


            }


        },

        methods: {


            reg : async function () {

                var self=this

                $.get("../apiUtente",{path: "registration", mail: self.email, pass: this.pass,nome:this.nome,cognome:this.cognome},
                    function (data) {
                        self.login_model=data
                        if(self.login_model['registration_state']==='succesful'){
                            window.location.href = '../index.html'
                        }
                        else {
                            self.reg_labl="Controllare I dati"
                        }
                    }
                )


            },




        },
        watch:{
            pass : function (){
                this.reg_labl=''
            },
            email : function (){
                this.reg_labl=''
            },
            nome : function (){
                this.reg_labl=''
            },
            cognome : function (){
                this.reg_labl=''
            },



        },

    });



</script>
</body>
</html>